<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Panel – Decent Kids Wear</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{
      --pink:#f472b6;--pink-light:#fce7f3;--pink-mid:#fbcfe8;--pink-dark:#db2777;
      --black:#111111;--gray:#6b7280;--gray-light:#f9fafb;--white:#ffffff;
      --sidebar:240px;--shadow:0 4px 24px rgba(244,114,182,0.13);
    }
    body{font-family:'Poppins',sans-serif;background:#f8f8f8;color:var(--black);display:flex;min-height:100vh}

    /* SIDEBAR */
    .sidebar{
      width:var(--sidebar);min-height:100vh;background:var(--white);
      border-right:1.5px solid var(--pink-mid);display:flex;flex-direction:column;
      position:fixed;top:0;left:0;z-index:100;
      box-shadow:2px 0 16px rgba(244,114,182,0.08);
      transition:transform 0.3s;
    }
    .sidebar-logo{
      padding:22px 20px 18px;border-bottom:1.5px solid var(--pink-mid);
      font-size:1.1rem;font-weight:800;color:var(--black);
      display:flex;align-items:center;gap:10px;
    }
    .sidebar-logo span{color:var(--pink)}
    .sidebar-logo svg{width:28px;height:28px;flex-shrink:0}
    .site-icon-preview{
      width:28px;height:28px;border-radius:6px;object-fit:cover;
      border:1.5px solid var(--pink-mid);display:none;
    }
    .nav-section{padding:10px 12px 4px;font-size:0.68rem;font-weight:700;
      color:var(--gray);letter-spacing:1px;text-transform:uppercase;margin-top:8px}
    .nav-item{
      display:flex;align-items:center;gap:10px;padding:11px 20px;
      font-size:0.87rem;font-weight:500;color:var(--gray);cursor:pointer;
      border-radius:10px;margin:2px 10px;transition:all 0.2s;border:none;
      background:none;width:calc(100% - 20px);text-align:left;
    }
    .nav-item svg{width:18px;height:18px;flex-shrink:0}
    .nav-item:hover{background:var(--pink-light);color:var(--pink-dark)}
    .nav-item.active{background:var(--pink-light);color:var(--pink-dark);font-weight:600}
    .nav-item .badge-count{
      margin-left:auto;background:var(--pink);color:var(--white);
      font-size:0.7rem;padding:1px 7px;border-radius:50px;font-weight:600;
    }
    .sidebar-footer{margin-top:auto;padding:16px 20px;border-top:1.5px solid var(--pink-mid)}
    .admin-profile-mini{display:flex;align-items:center;gap:10px}
    .admin-avatar{
      width:36px;height:36px;border-radius:50%;background:var(--pink-light);
      border:2px solid var(--pink-mid);display:flex;align-items:center;justify-content:center;
      font-size:0.8rem;font-weight:700;color:var(--pink-dark);flex-shrink:0;
    }
    .admin-name{font-size:0.83rem;font-weight:600;color:var(--black)}
    .admin-role{font-size:0.72rem;color:var(--gray)}
    .btn-logout{
      display:flex;align-items:center;gap:6px;padding:8px 14px;margin:10px 20px 16px;
      background:none;border:1.5px solid #fecdd3;color:#be123c;border-radius:8px;
      font-size:0.82rem;font-weight:600;cursor:pointer;font-family:'Poppins',sans-serif;
      transition:all 0.2s;width:calc(100% - 40px);justify-content:center;
    }
    .btn-logout:hover{background:#fff1f2}
    .btn-logout svg{width:15px;height:15px}

    /* MAIN */
    .main-content{margin-left:var(--sidebar);flex:1;display:flex;flex-direction:column;min-height:100vh}
    .topbar{
      background:var(--white);border-bottom:1.5px solid var(--pink-mid);
      padding:16px 28px;display:flex;align-items:center;justify-content:space-between;
      position:sticky;top:0;z-index:50;box-shadow:0 2px 10px rgba(244,114,182,0.07);
    }
    .topbar-title{font-size:1.1rem;font-weight:700;color:var(--black)}
    .topbar-sub{font-size:0.78rem;color:var(--gray);margin-top:1px}
    .topbar-right{display:flex;align-items:center;gap:12px}
    .btn-hamburger{
      display:none;background:none;border:none;cursor:pointer;padding:4px;
    }
    .btn-hamburger svg{width:22px;height:22px;color:var(--black)}
    .page-content{padding:28px;flex:1}

    /* SECTION PANELS */
    .section-panel{display:none}
    .section-panel.active{display:block}

    /* CARDS */
    .stat-card{
      background:var(--white);border:1.5px solid var(--pink-mid);border-radius:16px;
      padding:20px;box-shadow:var(--shadow);
    }
    .stat-icon{
      width:44px;height:44px;border-radius:12px;background:var(--pink-light);
      display:flex;align-items:center;justify-content:center;margin-bottom:12px;
    }
    .stat-icon svg{width:22px;height:22px;color:var(--pink-dark)}
    .stat-value{font-size:1.7rem;font-weight:800;color:var(--black);line-height:1}
    .stat-label{font-size:0.8rem;color:var(--gray);margin-top:4px}

    /* FORM CARD */
    .form-card{
      background:var(--white);border:1.5px solid var(--pink-mid);border-radius:18px;
      padding:28px;box-shadow:var(--shadow);margin-bottom:24px;
    }
    .form-card-title{font-size:1rem;font-weight:700;color:var(--black);margin-bottom:4px}
    .form-card-sub{font-size:0.8rem;color:var(--gray);margin-bottom:22px}
    .lbl{font-size:0.81rem;font-weight:600;color:var(--black);display:block;margin-bottom:6px}
    .inp{
      width:100%;padding:10px 13px;border:1.5px solid #e5e7eb;border-radius:10px;
      font-family:'Poppins',sans-serif;font-size:0.88rem;color:var(--black);
      background:var(--white);outline:none;transition:border-color 0.2s,box-shadow 0.2s;
      margin-bottom:16px;
    }
    .inp:focus{border-color:var(--pink);box-shadow:0 0 0 3px rgba(244,114,182,0.12)}
    select.inp{cursor:pointer}
    textarea.inp{resize:vertical;min-height:80px}
    .inp-file-area{
      border:2px dashed var(--pink-mid);border-radius:12px;padding:24px;
      text-align:center;cursor:pointer;transition:all 0.2s;background:var(--pink-light);
      margin-bottom:16px;position:relative;
    }
    .inp-file-area:hover{border-color:var(--pink);background:#fce7f3}
    .inp-file-area input[type=file]{
      position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;
    }
    .inp-file-area svg{width:32px;height:32px;color:var(--pink-dark);margin-bottom:8px}
    .inp-file-area p{font-size:0.82rem;color:var(--gray);margin:0}
    .inp-file-area strong{font-size:0.88rem;color:var(--pink-dark)}
    .img-preview{
      width:100%;max-height:180px;object-fit:cover;border-radius:10px;
      border:1.5px solid var(--pink-mid);margin-bottom:16px;display:none;
    }

    .btn-pink{
      padding:11px 22px;background:var(--pink);color:var(--white);border:none;
      border-radius:10px;font-family:'Poppins',sans-serif;font-size:0.9rem;font-weight:600;
      cursor:pointer;transition:all 0.2s;box-shadow:0 4px 14px rgba(244,114,182,0.28);
      display:inline-flex;align-items:center;gap:7px;
    }
    .btn-pink:hover{background:var(--pink-dark);transform:translateY(-1px)}
    .btn-pink svg{width:16px;height:16px}
    .btn-outline{
      padding:10px 20px;background:var(--white);color:var(--pink-dark);
      border:1.5px solid var(--pink);border-radius:10px;
      font-family:'Poppins',sans-serif;font-size:0.88rem;font-weight:600;
      cursor:pointer;transition:all 0.2s;display:inline-flex;align-items:center;gap:7px;
    }
    .btn-outline:hover{background:var(--pink-light)}
    .btn-outline svg{width:15px;height:15px}
    .btn-danger{
      padding:7px 14px;background:#fff1f2;color:#be123c;border:1.5px solid #fecdd3;
      border-radius:8px;font-family:'Poppins',sans-serif;font-size:0.8rem;font-weight:600;
      cursor:pointer;transition:all 0.2s;display:inline-flex;align-items:center;gap:5px;
    }
    .btn-danger:hover{background:#ffe4e6}
    .btn-danger svg{width:13px;height:13px}
    .btn-edit{
      padding:7px 14px;background:var(--pink-light);color:var(--pink-dark);
      border:1.5px solid var(--pink-mid);border-radius:8px;
      font-family:'Poppins',sans-serif;font-size:0.8rem;font-weight:600;
      cursor:pointer;transition:all 0.2s;display:inline-flex;align-items:center;gap:5px;
    }
    .btn-edit:hover{background:var(--pink-mid)}
    .btn-edit svg{width:13px;height:13px}

    /* PRODUCT TABLE */
    .product-table{width:100%;border-collapse:collapse}
    .product-table th{
      background:var(--pink-light);font-size:0.78rem;font-weight:700;
      color:var(--pink-dark);padding:11px 14px;text-align:left;
      border-bottom:1.5px solid var(--pink-mid);
    }
    .product-table td{
      padding:12px 14px;font-size:0.83rem;border-bottom:1px solid #f3f4f6;
      vertical-align:middle;
    }
    .product-table tr:hover td{background:#fdf2f8}
    .prod-img-thumb{
      width:44px;height:44px;border-radius:8px;object-fit:cover;
      border:1.5px solid var(--pink-mid);
    }
    .stock-badge{
      padding:3px 10px;border-radius:50px;font-size:0.73rem;font-weight:600;
    }
    .stock-in{background:#f0fdf4;color:#166534;border:1px solid #bbf7d0}
    .stock-out{background:#fff1f2;color:#be123c;border:1px solid #fecdd3}
    .sale-badge{
      background:var(--pink-light);color:var(--pink-dark);border:1px solid var(--pink-mid);
      padding:2px 8px;border-radius:50px;font-size:0.7rem;font-weight:700;
    }

    /* ALERT */
    .alert-box{
      padding:11px 16px;border-radius:10px;font-size:0.83rem;font-weight:500;
      margin-bottom:18px;display:none;
    }
    .alert-success{background:#f0fdf4;color:#166534;border:1px solid #bbf7d0}
    .alert-error{background:#fff1f2;color:#be123c;border:1px solid #fecdd3}

    /* EMPTY STATE */
    .empty-state{text-align:center;padding:40px 20px;color:var(--gray)}
    .empty-state svg{width:48px;height:48px;margin-bottom:12px;opacity:0.4}
    .empty-state p{font-size:0.88rem}

    /* CUSTOMERS TABLE */
    .customers-table{width:100%;border-collapse:collapse}
    .customers-table th{
      background:var(--pink-light);font-size:0.78rem;font-weight:700;
      color:var(--pink-dark);padding:11px 14px;text-align:left;
      border-bottom:1.5px solid var(--pink-mid);
    }
    .customers-table td{padding:11px 14px;font-size:0.82rem;border-bottom:1px solid #f3f4f6}
    .customers-table tr:hover td{background:#fdf2f8}

    /* SITE SETTINGS */
    .settings-icon-preview{
      width:80px;height:80px;border-radius:16px;object-fit:cover;
      border:2px solid var(--pink-mid);margin-bottom:12px;display:none;
    }
    .settings-icon-placeholder{
      width:80px;height:80px;border-radius:16px;background:var(--pink-light);
      border:2px dashed var(--pink-mid);display:flex;align-items:center;
      justify-content:center;margin-bottom:12px;
    }
    .settings-icon-placeholder svg{width:32px;height:32px;color:var(--pink-dark)}
    .banner-preview{
      width:100%;max-height:140px;object-fit:cover;border-radius:12px;
      border:1.5px solid var(--pink-mid);margin-bottom:12px;display:none;
    }

    /* OVERLAY */
    .sidebar-overlay{
      display:none;position:fixed;inset:0;background:rgba(0,0,0,0.4);z-index:90;
    }

    /* RESPONSIVE */
    @media(max-width:768px){
      .sidebar{transform:translateX(-100%)}
      .sidebar.open{transform:translateX(0)}
      .sidebar-overlay.open{display:block}
      .main-content{margin-left:0}
      .btn-hamburger{display:flex}
      .page-content{padding:16px}
      .topbar{padding:14px 16px}
    }
  </style>
</head>
<body>

<!-- SIDEBAR OVERLAY -->
<div class="sidebar-overlay" id="overlay" onclick="closeSidebar()"></div>

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-logo">
    <img class="site-icon-preview" id="sidebarIcon" src="" alt=""/>
    <svg id="sidebarDefaultIcon" viewBox="0 0 24 24" fill="none" stroke="#f472b6" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
    <div>
      <div style="font-size:0.95rem;font-weight:800;color:var(--black)">Decent <span style="color:var(--pink)">Kids</span></div>
      <div style="font-size:0.68rem;color:var(--gray);font-weight:500">Admin Panel</div>
    </div>
  </div>

  <div style="overflow-y:auto;flex:1">
    <div class="nav-section">Main</div>
    <button class="nav-item active" onclick="showSection('dashboard',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
      Dashboard
    </button>
    <div class="nav-section">Store</div>
    <button class="nav-item" onclick="showSection('add-product',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      Add Product
    </button>
    <button class="nav-item" onclick="showSection('manage-products',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
      Manage Products
      <span class="badge-count" id="prodCount">0</span>
    </button>
    <button class="nav-item" onclick="showSection('customers',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
      Customers
      <span class="badge-count" id="custCount">0</span>
    </button>
    <div class="nav-section">Settings</div>
    <button class="nav-item" onclick="showSection('site-settings',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
      Site Settings
    </button>
    <button class="nav-item" onclick="showSection('change-password',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
      Change Password
    </button>
  </div>

  <button class="btn-logout" onclick="logout()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
    Logout
  </button>
</aside>

<!-- MAIN CONTENT -->
<div class="main-content">
  <div class="topbar">
    <div>
      <div class="topbar-title" id="topbarTitle">Dashboard</div>
      <div class="topbar-sub" id="topbarSub">Overview of your store</div>
    </div>
    <div class="topbar-right">
      <button class="btn-hamburger" onclick="openSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
    </div>
  </div>

  <div class="page-content">

    <!-- ── DASHBOARD ── -->
    <div class="section-panel active" id="sec-dashboard">
      <div class="row g-3 mb-4">
        <div class="col-6 col-md-3">
          <div class="stat-card">
            <div class="stat-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg></div>
            <div class="stat-value" id="dash-products">0</div>
            <div class="stat-label">Total Products</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card">
            <div class="stat-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg></div>
            <div class="stat-value" id="dash-customers">0</div>
            <div class="stat-label">Customers</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card">
            <div class="stat-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg></div>
            <div class="stat-value" id="dash-orders">0</div>
            <div class="stat-label">Total Orders</div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card">
            <div class="stat-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
            <div class="stat-value" id="dash-revenue">₹0</div>
            <div class="stat-label">Revenue</div>
          </div>
        </div>
      </div>
      <!-- Recent products preview -->
      <div class="form-card">
        <div class="form-card-title">Recent Products</div>
        <div class="form-card-sub">Latest items added to your store</div>
        <div id="recentProducts"></div>
      </div>
    </div>

    <!-- ── ADD PRODUCT ── -->
    <div class="section-panel" id="sec-add-product">
      <div class="form-card">
        <div class="form-card-title">Add New Product</div>
        <div class="form-card-sub">Fill all details to list a product in the store</div>
        <div id="add-alert" class="alert-box"></div>
        <div class="row g-3">
          <div class="col-12">
            <label class="lbl">Product Image *</label>
            <div class="inp-file-area" id="imgDropArea">
              <input type="file" id="prodImg" accept="image/*" onchange="previewImg('prodImg','imgPreview','imgDropArea')"/>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
              <strong>Click or drop image here</strong>
              <p>JPG, PNG, WEBP – max 5MB</p>
            </div>
            <img class="img-preview" id="imgPreview" src="" alt="Preview"/>
          </div>
          <div class="col-md-6">
            <label class="lbl">Product Name *</label>
            <input type="text" id="pName" class="inp" placeholder="e.g. Floral Frock"/>
          </div>
          <div class="col-md-6">
            <label class="lbl">Category *</label>
            <select id="pCategory" class="inp">
              <option value="">Select category</option>
              <option>Tops & T-Shirts</option><option>Frocks & Dresses</option>
              <option>Pants & Shorts</option><option>Ethnic Wear</option>
              <option>Winter Wear</option><option>Accessories</option>
              <option>Footwear</option><option>School Uniform</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="lbl">Price (₹) *</label>
            <input type="number" id="pPrice" class="inp" placeholder="299"/>
          </div>
          <div class="col-md-4">
            <label class="lbl">Discount Price (₹)</label>
            <input type="number" id="pDiscount" class="inp" placeholder="199 (optional)"/>
          </div>
          <div class="col-md-4">
            <label class="lbl">Stock Quantity *</label>
            <input type="number" id="pStock" class="inp" placeholder="50"/>
          </div>
          <div class="col-md-6">
            <label class="lbl">Available Sizes</label>
            <input type="text" id="pSizes" class="inp" placeholder="S, M, L, XL or 2Y, 4Y, 6Y"/>
          </div>
          <div class="col-md-6">
            <label class="lbl">Age Group</label>
            <select id="pAge" class="inp">
              <option value="">Select age group</option>
              <option>0–2 Years</option><option>2–4 Years</option>
              <option>4–6 Years</option><option>6–8 Years</option>
              <option>8–10 Years</option><option>10–12 Years</option>
              <option>12+ Years</option>
            </select>
          </div>
          <div class="col-12">
            <label class="lbl">Description</label>
            <textarea id="pDesc" class="inp" placeholder="Product description, fabric, care instructions..."></textarea>
          </div>
          <div class="col-12 d-flex align-items-center gap-3">
            <label style="display:flex;align-items:center;gap:8px;font-size:0.85rem;font-weight:600;cursor:pointer">
              <input type="checkbox" id="pSale" style="accent-color:var(--pink);width:16px;height:16px"/>
              Mark as Sale / Featured
            </label>
          </div>
          <div class="col-12">
            <button class="btn-pink" onclick="addProduct()" id="addProdBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Add Product
            </button>
            <button class="btn-outline ms-2" onclick="resetProductForm()" style="margin-left:10px">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 .49-3.5"/></svg>
              Reset
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ── MANAGE PRODUCTS ── -->
    <div class="section-panel" id="sec-manage-products">
      <div class="form-card">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div>
            <div class="form-card-title">All Products</div>
            <div class="form-card-sub" style="margin-bottom:0">Manage your store inventory</div>
          </div>
          <button class="btn-pink" onclick="showSection('add-product',null)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            Add New
          </button>
        </div>
        <div style="overflow-x:auto">
          <table class="product-table" id="productTable">
            <thead>
              <tr>
                <th>Image</th><th>Name</th><th>Category</th>
                <th>Price</th><th>Stock</th><th>Sale</th><th>Actions</th>
              </tr>
            </thead>
            <tbody id="productTableBody"></tbody>
          </table>
        </div>
        <div id="noProducts" class="empty-state" style="display:none">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
          <p>No products yet. Add your first product!</p>
        </div>
      </div>
    </div>

    <!-- ── CUSTOMERS ── -->
    <div class="section-panel" id="sec-customers">
      <div class="form-card">
        <div class="form-card-title">Registered Customers</div>
        <div class="form-card-sub">All customer accounts</div>
        <div style="overflow-x:auto">
          <table class="customers-table" id="customersTable">
            <thead>
              <tr><th>ID</th><th>Name</th><th>Email</th><th>Phone</th><th>Age</th><th>Gender</th><th>Joined</th></tr>
            </thead>
            <tbody id="customersTableBody"></tbody>
          </table>
        </div>
        <div id="noCustomers" class="empty-state" style="display:none">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>
          <p>No customers registered yet.</p>
        </div>
      </div>
    </div>

    <!-- ── SITE SETTINGS ── -->
    <div class="section-panel" id="sec-site-settings">
      <div class="row g-4">
        <div class="col-md-6">
          <div class="form-card">
            <div class="form-card-title">App / Site Icon</div>
            <div class="form-card-sub">This icon shows as website favicon and app icon</div>
            <div id="iconPlaceholder" class="settings-icon-placeholder">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
            </div>
            <img class="settings-icon-preview" id="iconPreview" src="" alt="Site Icon"/>
            <div class="inp-file-area">
              <input type="file" accept="image/*" onchange="uploadSiteIcon(this)"/>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
              <strong>Upload Site Icon</strong><p>Square image recommended (512×512)</p>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-card">
            <div class="form-card-title">Hero Banner Image</div>
            <div class="form-card-sub">Shown on the customer homepage</div>
            <img class="banner-preview" id="bannerPreview" src="" alt="Banner"/>
            <div class="inp-file-area">
              <input type="file" accept="image/*" onchange="uploadBanner(this)"/>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
              <strong>Upload Banner</strong><p>1200×400px recommended</p>
            </div>
          </div>
        </div>
        <div class="col-12">
          <div class="form-card">
            <div class="form-card-title">Store Information</div>
            <div class="form-card-sub">These details appear on the customer-facing website</div>
            <div id="settings-alert" class="alert-box"></div>
            <div class="row g-3">
              <div class="col-md-6">
                <label class="lbl">Store Name</label>
                <input type="text" id="sStoreName" class="inp" placeholder="Decent Kids Wear"/>
              </div>
              <div class="col-md-6">
                <label class="lbl">Tagline</label>
                <input type="text" id="sTagline" class="inp" placeholder="Quality Fashion for Little Ones"/>
              </div>
              <div class="col-md-6">
                <label class="lbl">Contact Phone</label>
                <input type="text" id="sPhone" class="inp" placeholder="+91 9876543210"/>
              </div>
              <div class="col-md-6">
                <label class="lbl">Contact Email</label>
                <input type="email" id="sEmail" class="inp" placeholder="shop@decentkidswear.com"/>
              </div>
              <div class="col-12">
                <label class="lbl">Address</label>
                <input type="text" id="sAddress" class="inp" placeholder="Shop address"/>
              </div>
              <div class="col-12">
                <label class="lbl">About Store (short)</label>
                <textarea id="sAbout" class="inp" placeholder="A short description shown on the customer homepage..."></textarea>
              </div>
              <div class="col-12">
                <button class="btn-pink" onclick="saveSettings()">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                  Save Settings
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ── CHANGE PASSWORD ── -->
    <div class="section-panel" id="sec-change-password">
      <div class="form-card" style="max-width:460px">
        <div class="form-card-title">Change Admin Password</div>
        <div class="form-card-sub">Update your admin login credentials</div>
        <div id="pass-alert" class="alert-box"></div>
        <label class="lbl">Current Password</label>
        <input type="password" id="curPass" class="inp" placeholder="Current password"/>
        <label class="lbl">New Password</label>
        <input type="password" id="newPass" class="inp" placeholder="New password (min 6 chars)"/>
        <label class="lbl">Confirm New Password</label>
        <input type="password" id="confPass" class="inp" placeholder="Confirm new password"/>
        <button class="btn-pink" onclick="changePassword()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
          Update Password
        </button>
      </div>
    </div>

  </div><!-- end page-content -->
</div><!-- end main-content -->

<!-- EDIT PRODUCT MODAL -->
<div id="editModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:200;overflow-y:auto">
  <div style="background:var(--white);border-radius:20px;max-width:560px;margin:40px auto;padding:32px;position:relative">
    <button onclick="closeEditModal()" style="position:absolute;top:16px;right:16px;background:none;border:none;cursor:pointer;font-size:1.3rem;color:var(--gray)">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
    <div style="font-size:1.1rem;font-weight:700;margin-bottom:20px;color:var(--black)">Edit Product</div>
    <div class="inp-file-area">
      <input type="file" id="editImg" accept="image/*" onchange="previewImg('editImg','editImgPreview',null)"/>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
      <strong>Change Image</strong><p>Leave empty to keep current</p>
    </div>
    <img class="img-preview" id="editImgPreview" src="" alt=""/>
    <input type="hidden" id="editId"/>
    <div class="row g-3">
      <div class="col-md-6"><label class="lbl">Name</label><input type="text" id="editName" class="inp"/></div>
      <div class="col-md-6"><label class="lbl">Category</label>
        <select id="editCategory" class="inp">
          <option>Tops & T-Shirts</option><option>Frocks & Dresses</option>
          <option>Pants & Shorts</option><option>Ethnic Wear</option>
          <option>Winter Wear</option><option>Accessories</option>
          <option>Footwear</option><option>School Uniform</option>
        </select>
      </div>
      <div class="col-md-4"><label class="lbl">Price (₹)</label><input type="number" id="editPrice" class="inp"/></div>
      <div class="col-md-4"><label class="lbl">Discount (₹)</label><input type="number" id="editDiscount" class="inp"/></div>
      <div class="col-md-4"><label class="lbl">Stock</label><input type="number" id="editStock" class="inp"/></div>
      <div class="col-md-6"><label class="lbl">Sizes</label><input type="text" id="editSizes" class="inp"/></div>
      <div class="col-md-6"><label class="lbl">Age Group</label>
        <select id="editAge" class="inp">
          <option>0–2 Years</option><option>2–4 Years</option><option>4–6 Years</option>
          <option>6–8 Years</option><option>8–10 Years</option><option>10–12 Years</option><option>12+ Years</option>
        </select>
      </div>
      <div class="col-12"><label class="lbl">Description</label><textarea id="editDesc" class="inp"></textarea></div>
      <div class="col-12">
        <label style="display:flex;align-items:center;gap:8px;font-size:0.85rem;font-weight:600;cursor:pointer">
          <input type="checkbox" id="editSale" style="accent-color:var(--pink);width:16px;height:16px"/> Mark as Sale
        </label>
      </div>
      <div class="col-12"><button class="btn-pink" onclick="saveEdit()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        Save Changes
      </button></div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
// ── Auth Guard ──
if(localStorage.getItem('dkw_adminLoggedIn')!=='true'){
  window.location.href='index.html';
}

// ── Helpers ──
function getProducts(){ return JSON.parse(localStorage.getItem('dkw_products')||'[]'); }
function saveProducts(p){ localStorage.setItem('dkw_products',JSON.stringify(p)); }
function getCustomers(){ return JSON.parse(localStorage.getItem('dkw_customers')||'[]'); }
function getOrders(){ return JSON.parse(localStorage.getItem('dkw_orders')||'[]'); }
function showAlert(id,msg,type){
  const el=document.getElementById(id);
  el.className='alert-box alert-'+type; el.textContent=msg; el.style.display='block';
  setTimeout(()=>{el.style.display='none';},3500);
}

// ── Sidebar ──
function openSidebar(){
  document.getElementById('sidebar').classList.add('open');
  document.getElementById('overlay').classList.add('open');
}
function closeSidebar(){
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('overlay').classList.remove('open');
}

// ── Section Switch ──
const sectionTitles={
  'dashboard':['Dashboard','Overview of your store'],
  'add-product':['Add Product','List a new product in your store'],
  'manage-products':['Manage Products','Edit, delete and manage inventory'],
  'customers':['Customers','View all registered customers'],
  'site-settings':['Site Settings','Manage your store appearance'],
  'change-password':['Change Password','Update admin credentials']
};
function showSection(name, btn){
  document.querySelectorAll('.section-panel').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(b=>b.classList.remove('active'));
  document.getElementById('sec-'+name).classList.add('active');
  if(btn) btn.classList.add('active');
  const t=sectionTitles[name]||[name,''];
  document.getElementById('topbarTitle').textContent=t[0];
  document.getElementById('topbarSub').textContent=t[1];
  closeSidebar();
  if(name==='dashboard') loadDashboard();
  if(name==='manage-products') loadProductTable();
  if(name==='customers') loadCustomers();
  if(name==='site-settings') loadSettings();
}

// ── Image Preview ──
function previewImg(inputId, previewId){
  const file=document.getElementById(inputId).files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=e=>{
    const img=document.getElementById(previewId);
    img.src=e.target.result; img.style.display='block';
  };
  reader.readAsDataURL(file);
}

// ── Add Product ──
function addProduct(){
  const name=document.getElementById('pName').value.trim();
  const cat=document.getElementById('pCategory').value;
  const price=document.getElementById('pPrice').value;
  const discount=document.getElementById('pDiscount').value;
  const stock=document.getElementById('pStock').value;
  const sizes=document.getElementById('pSizes').value.trim();
  const age=document.getElementById('pAge').value;
  const desc=document.getElementById('pDesc').value.trim();
  const sale=document.getElementById('pSale').checked;
  const imgFile=document.getElementById('prodImg').files[0];
  if(!name||!cat||!price||!stock){ showAlert('add-alert','Please fill required fields (Name, Category, Price, Stock).','error'); return; }
  function finalSave(imgData){
    const products=getProducts();
    const newProd={
      id:'P'+Date.now(), name, category:cat, price:parseFloat(price),
      discountPrice:discount?parseFloat(discount):null,
      stock:parseInt(stock), sizes, ageGroup:age, description:desc,
      sale, image:imgData, createdAt:new Date().toLocaleDateString('en-IN')
    };
    products.push(newProd);
    saveProducts(products);
    showAlert('add-alert','Product added successfully!','success');
    updateCounts();
    resetProductForm();
  }
  if(imgFile){
    const reader=new FileReader();
    reader.onload=e=>finalSave(e.target.result);
    reader.readAsDataURL(imgFile);
  } else { finalSave(''); }
}

function resetProductForm(){
  ['pName','pPrice','pDiscount','pStock','pSizes','pDesc'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('pCategory').value='';
  document.getElementById('pAge').value='';
  document.getElementById('pSale').checked=false;
  document.getElementById('prodImg').value='';
  const prev=document.getElementById('imgPreview');
  prev.src=''; prev.style.display='none';
}

// ── Load Product Table ──
function loadProductTable(){
  const products=getProducts();
  const tbody=document.getElementById('productTableBody');
  const empty=document.getElementById('noProducts');
  if(products.length===0){ tbody.innerHTML=''; empty.style.display='block'; return; }
  empty.style.display='none';
  tbody.innerHTML=products.map(p=>`
    <tr>
      <td>${p.image?`<img src="${p.image}" class="prod-img-thumb" alt="${p.name}"/>`:`<div style="width:44px;height:44px;border-radius:8px;background:var(--pink-light);display:flex;align-items:center;justify-content:center"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#db2777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg></div>`}</td>
      <td><div style="font-weight:600;color:var(--black)">${p.name}</div><div style="font-size:0.73rem;color:var(--gray)">${p.ageGroup||''}</div></td>
      <td><span style="font-size:0.8rem">${p.category}</span></td>
      <td>
        <div style="font-weight:700;color:var(--black)">₹${p.price}</div>
        ${p.discountPrice?`<div style="font-size:0.73rem;color:#db2777;text-decoration:line-through">₹${p.price}</div><div style="font-size:0.8rem;font-weight:700;color:#166534">₹${p.discountPrice}</div>`:''}
      </td>
      <td><span class="stock-badge ${p.stock>0?'stock-in':'stock-out'}">${p.stock>0?p.stock+' in stock':'Out of stock'}</span></td>
      <td>${p.sale?'<span class="sale-badge">SALE</span>':'<span style="color:var(--gray);font-size:0.78rem">—</span>'}</td>
      <td style="white-space:nowrap">
        <button class="btn-edit me-1" onclick="openEditModal('${p.id}')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
          Edit
        </button>
        <button class="btn-danger" onclick="deleteProduct('${p.id}')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4h6v2"/></svg>
          Delete
        </button>
      </td>
    </tr>
  `).join('');
}

function deleteProduct(id){
  if(!confirm('Delete this product?')) return;
  let products=getProducts().filter(p=>p.id!==id);
  saveProducts(products);
  loadProductTable();
  updateCounts();
}

// ── Edit Modal ──
function openEditModal(id){
  const p=getProducts().find(p=>p.id===id);
  if(!p) return;
  document.getElementById('editId').value=id;
  document.getElementById('editName').value=p.name;
  document.getElementById('editCategory').value=p.category;
  document.getElementById('editPrice').value=p.price;
  document.getElementById('editDiscount').value=p.discountPrice||'';
  document.getElementById('editStock').value=p.stock;
  document.getElementById('editSizes').value=p.sizes||'';
  document.getElementById('editAge').value=p.ageGroup||'';
  document.getElementById('editDesc').value=p.description||'';
  document.getElementById('editSale').checked=p.sale||false;
  const prev=document.getElementById('editImgPreview');
  if(p.image){ prev.src=p.image; prev.style.display='block'; }
  else { prev.src=''; prev.style.display='none'; }
  document.getElementById('editImg').value='';
  document.getElementById('editModal').style.display='block';
}
function closeEditModal(){ document.getElementById('editModal').style.display='none'; }
function saveEdit(){
  const id=document.getElementById('editId').value;
  const products=getProducts();
  const idx=products.findIndex(p=>p.id===id);
  if(idx===-1) return;
  function doSave(imgData){
    products[idx]={
      ...products[idx],
      name:document.getElementById('editName').value.trim(),
      category:document.getElementById('editCategory').value,
      price:parseFloat(document.getElementById('editPrice').value),
      discountPrice:document.getElementById('editDiscount').value?parseFloat(document.getElementById('editDiscount').value):null,
      stock:parseInt(document.getElementById('editStock').value),
      sizes:document.getElementById('editSizes').value.trim(),
      ageGroup:document.getElementById('editAge').value,
      description:document.getElementById('editDesc').value.trim(),
      sale:document.getElementById('editSale').checked,
      image:imgData
    };
    saveProducts(products);
    closeEditModal();
    loadProductTable();
    updateCounts();
  }
  const file=document.getElementById('editImg').files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=e=>doSave(e.target.result);
    reader.readAsDataURL(file);
  } else { doSave(products[idx].image); }
}

// ── Customers ──
function loadCustomers(){
  const customers=getCustomers();
  const tbody=document.getElementById('customersTableBody');
  const empty=document.getElementById('noCustomers');
  if(customers.length===0){ tbody.innerHTML=''; empty.style.display='block'; return; }
  empty.style.display='none';
  tbody.innerHTML=customers.map(c=>`
    <tr>
      <td style="font-size:0.75rem;color:var(--gray)">${c.id}</td>
      <td style="font-weight:600">${c.name}</td>
      <td>${c.email}</td>
      <td>${c.phone}</td>
      <td>${c.age}</td>
      <td>${c.gender}</td>
      <td style="font-size:0.78rem;color:var(--gray)">${c.createdAt}</td>
    </tr>
  `).join('');
}

// ── Site Settings ──
function uploadSiteIcon(input){
  const file=input.files[0]; if(!file) return;
  const reader=new FileReader();
  reader.onload=e=>{
    localStorage.setItem('dkw_siteIcon',e.target.result);
    document.getElementById('iconPreview').src=e.target.result;
    document.getElementById('iconPreview').style.display='block';
    document.getElementById('iconPlaceholder').style.display='none';
    // update sidebar icon
    const si=document.getElementById('sidebarIcon');
    si.src=e.target.result; si.style.display='block';
    document.getElementById('sidebarDefaultIcon').style.display='none';
    // update favicon
    setFavicon(e.target.result);
  };
  reader.readAsDataURL(file);
}
function uploadBanner(input){
  const file=input.files[0]; if(!file) return;
  const reader=new FileReader();
  reader.onload=e=>{
    localStorage.setItem('dkw_banner',e.target.result);
    const prev=document.getElementById('bannerPreview');
    prev.src=e.target.result; prev.style.display='block';
  };
  reader.readAsDataURL(file);
}
function setFavicon(src){
  let link=document.querySelector("link[rel~='icon']");
  if(!link){ link=document.createElement('link'); link.rel='icon'; document.head.appendChild(link); }
  link.href=src;
}
function loadSettings(){
  const icon=localStorage.getItem('dkw_siteIcon');
  if(icon){
    document.getElementById('iconPreview').src=icon;
    document.getElementById('iconPreview').style.display='block';
    document.getElementById('iconPlaceholder').style.display='none';
  }
  const banner=localStorage.getItem('dkw_banner');
  if(banner){
    const bp=document.getElementById('bannerPreview');
    bp.src=banner; bp.style.display='block';
  }
  const info=JSON.parse(localStorage.getItem('dkw_storeInfo')||'{}');
  if(info.storeName) document.getElementById('sStoreName').value=info.storeName;
  if(info.tagline)   document.getElementById('sTagline').value=info.tagline;
  if(info.phone)     document.getElementById('sPhone').value=info.phone;
  if(info.email)     document.getElementById('sEmail').value=info.email;
  if(info.address)   document.getElementById('sAddress').value=info.address;
  if(info.about)     document.getElementById('sAbout').value=info.about;
}
function saveSettings(){
  const info={
    storeName:document.getElementById('sStoreName').value.trim(),
    tagline:document.getElementById('sTagline').value.trim(),
    phone:document.getElementById('sPhone').value.trim(),
    email:document.getElementById('sEmail').value.trim(),
    address:document.getElementById('sAddress').value.trim(),
    about:document.getElementById('sAbout').value.trim()
  };
  localStorage.setItem('dkw_storeInfo',JSON.stringify(info));
  showAlert('settings-alert','Settings saved successfully!','success');
}

// ── Change Password ──
function changePassword(){
  const cur=document.getElementById('curPass').value;
  const nw=document.getElementById('newPass').value;
  const conf=document.getElementById('confPass').value;
  const admin=JSON.parse(localStorage.getItem('dkw_admin'));
  if(cur!==admin.password){ showAlert('pass-alert','Current password is incorrect.','error'); return; }
  if(nw.length<6){ showAlert('pass-alert','New password must be at least 6 characters.','error'); return; }
  if(nw!==conf){ showAlert('pass-alert','Passwords do not match.','error'); return; }
  admin.password=nw;
  localStorage.setItem('dkw_admin',JSON.stringify(admin));
  showAlert('pass-alert','Password updated successfully!','success');
  ['curPass','newPass','confPass'].forEach(id=>document.getElementById(id).value='');
}

// ── Dashboard ──
function loadDashboard(){
  const products=getProducts();
  const customers=getCustomers();
  const orders=getOrders();
  document.getElementById('dash-products').textContent=products.length;
  document.getElementById('dash-customers').textContent=customers.length;
  document.getElementById('dash-orders').textContent=orders.length;
  const revenue=orders.reduce((s,o)=>s+(o.total||0),0);
  document.getElementById('dash-revenue').textContent='₹'+revenue.toLocaleString('en-IN');
  // Recent products
  const recent=products.slice(-5).reverse();
  const rp=document.getElementById('recentProducts');
  if(recent.length===0){ rp.innerHTML='<div class="empty-state"><p>No products yet.</p></div>'; return; }
  rp.innerHTML=`<div style="display:flex;flex-direction:column;gap:10px">${recent.map(p=>`
    <div style="display:flex;align-items:center;gap:12px;padding:10px;border:1px solid #f3f4f6;border-radius:10px">
      ${p.image?`<img src="${p.image}" style="width:40px;height:40px;border-radius:8px;object-fit:cover;border:1.5px solid var(--pink-mid)" alt=""/>`:
      `<div style="width:40px;height:40px;border-radius:8px;background:var(--pink-light);display:flex;align-items:center;justify-content:center">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#db2777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
      </div>`}
      <div style="flex:1"><div style="font-weight:600;font-size:0.87rem">${p.name}</div>
      <div style="font-size:0.75rem;color:var(--gray)">${p.category} · ₹${p.price}</div></div>
      <span class="stock-badge ${p.stock>0?'stock-in':'stock-out'}">${p.stock>0?p.stock:0}</span>
    </div>
  `).join('')}</div>`;
}

// ── Update counts ──
function updateCounts(){
  const pc=getProducts().length;
  const cc=getCustomers().length;
  document.getElementById('prodCount').textContent=pc;
  document.getElementById('custCount').textContent=cc;
}

// ── Logout ──
function logout(){
  if(!confirm('Logout from admin panel?')) return;
  localStorage.removeItem('dkw_adminLoggedIn');
  window.location.href='index.html';
}

// ── Init ──
(function(){
  updateCounts();
  loadDashboard();
  // Load saved site icon into sidebar
  const icon=localStorage.getItem('dkw_siteIcon');
  if(icon){
    const si=document.getElementById('sidebarIcon');
    si.src=icon; si.style.display='block';
    document.getElementById('sidebarDefaultIcon').style.display='none';
    setFavicon(icon);
  }
})();
</script>
</body>
</html>